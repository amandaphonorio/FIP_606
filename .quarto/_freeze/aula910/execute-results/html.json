{
  "hash": "a5030d7eea855bee22d0e06c217815bb",
  "result": {
    "markdown": "---\ntitle: \"Aula 9 e 10\"\nformat: html\n---\n\n\n# Parcela subdividida\n\nCarregamos os pacotes `tidyverse` e `gsheet` para importar e os dados de uma planilha do Google Drive. Usamos a função `gsheet2tbl` para ler os dados da planilha, o objeto foi nomeado como `milho`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(gsheet)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'gsheet' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\n```\n:::\n\n\n# Visualização dos dados\n\nUtilizamos o pacote `ggplot2`, que faz parte do `tidyverse`. A função ggplot foi usada para criar uma visualização dos dados, especificando as variáveis method e index para os eixos x e y, respectivamente. A função geom_jitter adicionou pontos de dispersão com um pequeno desvio horizontal (width = 0.1) para evitar sobreposição e com transparência (alpha = 0.2) para melhor visualização. A função `facet_wrap` foi utilizada para criar gráficos separados para cada nível da variável hybrid, permitindo comparar os dados entre diferentes híbridos de milho. Finalmente, a função `stat_summary` adicionou uma linha de resumo estatístico que mostra a média e o intervalo de confiança (calculado pelo método bootstrap). Isso resulta em uma visualização detalhada que facilita a análise comparativa dos dados entre diferentes métodos e híbridos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho |> \n  ggplot(aes(method, index))+\n  geom_jitter(width = 0.1, alpha = 0.2)+\n  facet_wrap(~ hybrid)+\n stat_summary(fun.data = \"mean_cl_boot\", size =0.5, color = \"green\")\n```\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n# Modelo para subdividida\n\nCarregamos pacote `lme4` e a variável block é convertida em um fator utilizando a função `mutate`. Um modelo misto linear (lmer) foi ajustado para a raiz quadrada do índice, incluindo os efeitos principais e interações entre hybrid e method, além de block como efeito fixo e block aninhado dentro de hybrid como efeito aleatório. A função `Anova` do pacote `car` foi utilizada para realizar uma análise de variância no modelo. As funções `check_normality` e `check_heteroscedasticity` do pacote `performance` foram usadas para verificar a normalidade dos resíduos e a heterocedasticidade do modelo, respectivamente. O pacote `DHARMa` foi utilizado para simular e plotar resíduos, fornecendo diagnósticos visuais da adequação do modelo, incluindo um gráfico Q-Q e um histograma dos resíduos. O pacote `emmeans` foi empregado para calcular as médias marginais dos híbridos dentro de cada método (hybrid \\| method) e dos métodos dentro de cada híbrido (method \\| hybrid), apresentando os resultados no formato de resposta original. As comparações de médias foram visualizadas com a função `cld` do pacote `multcomp`, que adiciona letras às médias para indicar diferenças estatisticamente significativas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: Matrix\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'Matrix'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n```\n:::\n\n```{.r .cell-code}\nmilho <- milho |> \n  mutate(block = as.factor(block))\n\nmix2 <- lmer(sqrt(index) ~ hybrid*method + block + (1|block/hybrid), data =  milho)\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'car' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    some\n```\n:::\n\n```{.r .cell-code}\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(index)\n                Chisq Df Pr(>Chisq)   \nhybrid        15.3159  5   0.009095 **\nmethod         3.8886  1   0.048615 * \nblock          0.0783  3   0.994305   \nhybrid:method 13.3812  5   0.020057 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nmix2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: sqrt(index) ~ hybrid * method + block + (1 | block/hybrid)\n   Data: milho\nREML criterion at convergence: 72.5662\nRandom effects:\n Groups       Name        Std.Dev.\n hybrid:block (Intercept) 0.4644  \n block        (Intercept) 2.2518  \n Residual                 0.3742  \nNumber of obs: 48, groups:  hybrid:block, 24; block, 4\nFixed Effects:\n              (Intercept)             hybrid30F53 YH  \n                  4.65420                   -0.04446  \n              hybrid30K64               hybrid30S31H  \n                 -0.49224                    1.09866  \n            hybrid30S31YH              hybridBG7049H  \n                  0.63521                   -0.58990  \n               methodsilk                     block2  \n                 -0.05317                    0.06156  \n                   block3                     block4  \n                  0.56679                    0.73537  \nhybrid30F53 YH:methodsilk     hybrid30K64:methodsilk  \n                  0.20604                    0.16534  \n  hybrid30S31H:methodsilk   hybrid30S31YH:methodsilk  \n                 -0.91003                   -0.43778  \n hybridBG7049H:methodsilk  \n                  0.01751  \n```\n:::\n\n```{.r .cell-code}\nlibrary(performance)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'performance' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.440).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.970).\n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'DHARMa' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThis is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'emmeans' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nmedias_milho <- emmeans(mix2,\n                        ~ hybrid | method,\n                        type = \"response\")\nmedias_milho2 <- emmeans(mix2,\n                        ~ method | hybrid, \n                        type = \"response\")\nlibrary(multcomp)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'multcomp' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: mvtnorm\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: survival\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: TH.data\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: MASS\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'MASS'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    select\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'TH.data'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:MASS':\n\n    geyser\n```\n:::\n\n```{.r .cell-code}\ncld(medias_milho2, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method response   SE   df lower.CL upper.CL .group\n silk       24.4 11.5 5155     7.07     52.2  A    \n pin        25.0 11.6 5155     7.35     53.0  A    \n\nhybrid = 30F53 YH:\n method response   SE   df lower.CL upper.CL .group\n pin        24.5 11.5 5155     7.11     52.3  A    \n silk       26.0 11.9 5155     7.95     54.6  A    \n\nhybrid = 30K64:\n method response   SE   df lower.CL upper.CL .group\n pin        20.3 10.5 5155     4.93     46.1  A    \n silk       21.3 10.8 5155     5.44     47.6  A    \n\nhybrid = 30S31H:\n method response   SE   df lower.CL upper.CL .group\n silk       26.3 12.0 5155     8.11     55.0  A    \n pin        37.1 14.2 5155    14.52     70.2   B   \n\nhybrid = 30S31YH:\n method response   SE   df lower.CL upper.CL .group\n silk       26.4 12.0 5155     8.16     55.1  A    \n pin        31.7 13.1 5155    11.20     62.6  A    \n\nhybrid = BG7049H:\n method response   SE   df lower.CL upper.CL .group\n silk       19.1 10.2 5155     4.35     44.3  A    \n pin        19.4 10.3 5155     4.50     44.7  A    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nUm segundo modelo misto linear (mix3) foi ajustado para a raiz quadrada do rendimento (yield) com a mesma estrutura de efeitos. A análise de variância e verificações de heterocedasticidade e normalidade também foram aplicadas ao novo modelo. Este conjunto abrangente de análises fornece uma avaliação detalhada das interações entre híbridos e métodos, além de garantir que os pressupostos do modelo sejam atendidos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmix3 <- lmer(sqrt(yield) ~ hybrid*method + block + (1|block/hybrid), data =  milho)\n\nAnova(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(yield)\n                Chisq Df Pr(>Chisq)    \nhybrid        25.5591  5  0.0001086 ***\nmethod         0.0520  1  0.8196750    \nblock          2.3606  3  0.5010021    \nhybrid:method 24.4985  5  0.0001741 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.686).\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.214).\n```\n:::\n:::\n\n\n# Regressão linear\n\nImportamos uma planilha do Google Drive contendo informações sobre o estande de plantas (estande). O pacote `gsheet` foi utilizada para importar os dados, e o pacote `ggplot2` do tidyverse é utilizado para criar visualizações. Primeiramente, fizemos um gráfico de dispersão com os dados de trat (tratamentos) e nplants (número de plantas), onde `geom_jitter` adicionou pontos com um pequeno desvio horizontal para evitar sobreposição. A função `facet_wrap` criou gráficos separados para cada experimento (exp), `stat_summary` adicionou uma linha de resumo estatístico mostrando a média e o intervalo de confiança, enquanto `geom_smooth` adicionou uma linha de ajuste linear sem intervalo de confiança. Em seguida, os dados foram filtrados para selecionar apenas o experimento 2 (exp2). Um novo gráfico de dispersão foi criado para esses dados, com pontos individuais `geom_point`, e duas linhas de ajuste: uma quadrática `geom_smooth` com formula = y \\~ poly(x,2)) e uma linear simples `geom_smooth`. Para modelagem estatística, um modelo linear de primeira ordem (lm2) e um modelo quadrático de segunda ordem (lm3) foram ajustados aos dados do experimento 2. As somas de quadrados e os coeficientes de cada modelo são resumidos com `summary`. O critério de informação de Akaike (AIC) foi calculado para comparar a qualidade dos modelos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\nestande |> \n  ggplot(aes(trat, nplants))+\n  geom_jitter(width = 0.1, alpha = 0.5)+\n  facet_wrap(~ exp)+\n  stat_summary(fun.data = \"mean_cl_boot\", size =0.5, color = \"turquoise\")+\n geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nexp2 <- estande |> \n  filter(exp == 2)\n\nexp2 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim(0,100)+\n  geom_smooth(method= \"lm\", \n              se=FALSE, \n              formula = y ~poly(x,2), color=\"black\")+\n  geom_smooth(method = \"lm\",\n              se = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# modelo linear\n\nexp2$trat2 <- exp2$trat^2 \n  \n# primeira ordem\nlm2 <- lm(nplants ~ trat, \n          data = exp2)\n# segunda ordem ou quadrático\nlm3 <- lm(nplants ~ trat + trat2 , \n          data = exp2)\n\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n\n```{.r .cell-code}\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,\tAdjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n```\n:::\n\n```{.r .cell-code}\nAIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 194.9597\n```\n:::\n\n```{.r .cell-code}\nAIC(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 193.1284\n```\n:::\n:::\n\n\nUtilizamos o conjunto de dados WhiteMoldSoybean (wm) da biblioteca `r4pde`, que parece conter informações sobre a relação entre a incidência de mofo branco (inc) e a produtividade de soja (yld). A seguir criamos visualizações e ajusta um modelo linear simples para investigar essa relação. Os dados foram visualizados com `ggplot2`, criamos um gráfico de dispersão, usando a função `geom_point()`, onde inc (incidência) é mapeado no eixo x e yld (produtividade) no eixo y. A variável study foi utilizada para agrupar os dados, diferenciando-os por estudo. Para a linha de ajuste usamos `geom_smooth(method = \"lm\", se = F)`que ajuda a visualizar a tendência linear entre inc e yld. A função `theme_minimal` aplica um tema minimalista ao gráfico para uma apresentação mais limpa. Em seguida, um modelo linear (mofo1) foi ajustado para os dados com lm(yld \\~ inc, data = wm), onde a produtividade (yld) foi modelada como uma função linear da incidência (inc). O resumo do modelo (summary(mofo1)) foi gerado para avaliar a significância estatística da relação, os coeficientes do modelo, e outras estatísticas relevantes, como o valor de R² e o p-valor. Esse processo fornece uma visão clara da relação entre a incidência de mofo branco e a produtividade de soja, tanto visualmente quanto estatisticamente, permitindo uma melhor compreensão do impacto dessa doença na produção agrícola.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\nglm3 <- glmer(nplants ~ trat + (trat | exp), family = \"gaussian\",\n            data = estande)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in glmer(nplants ~ trat + (trat | exp), family = \"gaussian\", data =\nestande): calling glmer() with family=gaussian (identity link) as a shortcut to\nlmer() is deprecated; please call lmer() directly\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in checkConv(attr(opt, \"derivs\"), opt$par, ctrl = control$checkConv, :\nModel failed to converge with max|grad| = 0.00274249 (tol = 0.002, component 1)\n```\n:::\n\n```{.r .cell-code}\nsummary(glm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\n\nREML criterion at convergence: 580.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.0988 -0.6091  0.1722  0.6360  1.9963 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n exp      (Intercept) 510.68405 22.5983       \n          trat          0.05516  0.2349  -0.82\n Residual             167.91303 12.9581       \nNumber of obs: 72, groups:  exp, 3\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  69.7452    13.2146   5.278\ntrat         -0.5687     0.1643  -3.462\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.731\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.00274249 (tol = 0.002, component 1)\n```\n:::\n\n```{.r .cell-code}\nAIC(glm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 592.8402\n```\n:::\n\n```{.r .cell-code}\nglmb3 <- glmer(nplants ~ trat + (trat | exp), family = poisson(link = \"log\"), \n             data = estande)\nsummary(glmb3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: poisson  ( log )\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\n\n     AIC      BIC   logLik deviance df.resid \n   660.7    672.1   -325.4    650.7       67 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.6247 -0.8083  0.1042  0.9601  3.6511 \n\nRandom effects:\n Groups Name        Variance  Std.Dev. Corr \n exp    (Intercept) 6.425e-02 0.253478      \n        trat        1.602e-05 0.004003 -0.17\nNumber of obs: 72, groups:  exp, 3\n\nFixed effects:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.223397   0.147793  28.577  < 2e-16 ***\ntrat        -0.010434   0.002538  -4.111 3.93e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.192\n```\n:::\n\n```{.r .cell-code}\nAIC(glmb3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 660.7282\n```\n:::\n\n```{.r .cell-code}\nremotes::install_github(\"emdelponte/r4pde\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSkipping install of 'r4pde' from a github remote, the SHA1 (42e6615b) has not changed since last install.\n  Use `force = TRUE` to force installation\n```\n:::\n\n```{.r .cell-code}\nlibrary(r4pde)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: replacing previous import 'car::recode' by 'dplyr::recode' when\nloading 'r4pde'\n```\n:::\n\n```{.r .cell-code}\nwm <- WhiteMoldSoybean\n\nwm |> \n  ggplot(aes(inc, yld, group = factor(study)))+\n  geom_point()+\n  #facet_wrap(~study)+\n  theme_minimal()+\n  geom_smooth(method = \"lm\", se = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmofo1 <- lm(yld ~ inc, data = wm)\nsummary(mofo1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = yld ~ inc, data = wm)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1657.85  -594.50   -91.32   531.76  1693.15 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3299.619     56.451  58.451  < 2e-16 ***\ninc           -9.261      2.108  -4.393 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 745.8 on 380 degrees of freedom\nMultiple R-squared:  0.04833,\tAdjusted R-squared:  0.04582 \nF-statistic:  19.3 on 1 and 380 DF,  p-value: 1.452e-05\n```\n:::\n:::\n\n\nCarregamos os pacotes `broom`, `ggplot2`, `patchwork`, e `r4pde` para ajustar modelos lineares, extrair coeficientes, e visualizá-los. Para cada estudo (study), um modelo linear foi ajustado (lm(.$yld ~ .$inc)) e os coeficientes do modelo, incluindo intervalos de confiança, são extraídos usando a função `tidy` do pacote `broom`. Crio-se um histograma das inclinações (estimate) dos coeficientes para inc filtrados do resultado do ajuste do modelo linear (term == \".\\$inc\"). O tema `theme_r4pde` é aplicado para estilizar o gráfico. De forma semelhante, criou-se um histograma dos interceptos dos modelos ajustados. A média das inclinações dos coeficientes para inc foi calculada. Um segundo histograma das inclinações foi criado (parecido com o primeiro), e os gráficos de interceptos e inclinações são combinados lado a lado utilizando o pacote `patchwork`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'broom' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(patchwork)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'patchwork' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'patchwork'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:MASS':\n\n    area\n```\n:::\n\n```{.r .cell-code}\n# Supondo que 'wm' seja um dataframe existente no ambiente\n# Criação do objeto 'mofo2'\nmofo2 <- wm |> \n  group_by(study) |> \n  do(tidy(lm(yld ~ inc, data = .), conf.int = TRUE))\n\n# Criação do objeto 'fit_all' a partir de 'mofo2'\nfit_all <- mofo2\n\n# Filtrando e criando o gráfico 'fit_all'\np1 <- fit_all |> \n  filter(term == \"inc\") |> \n  ggplot(aes(x = estimate)) +\n  geom_histogram(bins = 8, color = \"white\", fill = \"gray50\") +\n  theme_minimal() +\n  labs(x = \"slopes\", y = \"Frequency\")\n\n# Criando o gráfico 'p3'\np3 <- fit_all |> \n  filter(term == \"(Intercept)\") |> \n  ggplot(aes(x = estimate)) +\n  geom_histogram(bins = 8, color = \"white\", fill = \"gray50\") +\n  theme_minimal() +\n  labs(x = \"Intercept\", y = \"Frequency\")\n\n# Calculando a média dos coeficientes de inclinação\ndf <- mofo2 |> filter(term == \"inc\")\nmean_slope <- mean(df$estimate)\nprint(mean_slope)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -19.52932\n```\n:::\n\n```{.r .cell-code}\n# Criando o gráfico 'p4'\np4 <- fit_all |> \n  filter(term == \"inc\") |> \n  ggplot(aes(x = estimate)) +\n  geom_histogram(bins = 8, color = \"white\", fill = \"gray50\") +\n  theme_minimal() +\n  labs(x = \"Slope\", y = \"Frequency\")\n\n# Combinando os gráficos 'p3' e 'p4' usando patchwork\ncombined_plot <- p3 | p4\nprint(combined_plot)\n```\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nutilizamos o pacote `lme4`, para ajustar um modelo linear misto. Obtivemos um resumo, uma ANOVA e intervalos de confiança.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\nmofo3 <- lmer(yld ~ inc + (inc |study), data = wm, \n            REML = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in checkConv(attr(opt, \"derivs\"), opt$par, ctrl = control$checkConv, :\nModel failed to converge with max|grad| = 0.416806 (tol = 0.002, component 1)\n```\n:::\n\n```{.r .cell-code}\nsummary(mofo3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by maximum likelihood  ['lmerMod']\nFormula: yld ~ inc + (inc | study)\n   Data: wm\n\n     AIC      BIC   logLik deviance df.resid \n  5319.4   5343.1  -2653.7   5307.4      376 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.7078 -0.5991 -0.0295  0.5077  3.2364 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n study    (Intercept) 557573.08 746.708       \n          inc             36.85   6.071  -0.29\n Residual              37228.73 192.947       \nNumber of obs: 382, groups:  study, 35\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 3455.432    128.063   26.98\ninc          -17.236      1.451  -11.88\n\nCorrelation of Fixed Effects:\n    (Intr)\ninc -0.300\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.416806 (tol = 0.002, component 1)\n```\n:::\n\n```{.r .cell-code}\nAnova(mofo3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: yld\n     Chisq Df Pr(>Chisq)    \ninc 141.09  1  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nconfint(mofo3, method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 2.5 %     97.5 %\n.sig01              NA         NA\n.sig02              NA         NA\n.sig03              NA         NA\n.sigma              NA         NA\n(Intercept) 3204.43403 3706.43096\ninc          -20.08046  -14.39219\n```\n:::\n:::\n\n\nCarregamos os pacotes `tidyverse`, `gsheet`, `AgroR`, `corrplo`t e dplyr. Em seguida, os dados foram importados de uma planilha do Google Drive usando a função `gsheet2tbl`. Os dados foram transformados com `pivot_longer` para reorganizar colunas em valores de method e value, que foram plotados em um boxplot. Um scatter plot com linha de tendência foi gerado para as variáveis Assess e ImageJ. As colunas 3 a 5 do dataframe imgs foram selecionadas com `dplyr::select` e usadas para calcular a correlação com `corgraph`. Testes de correlação entre Assess e LeafDoctor foram realizados com cor.test e cor. Outro conjunto de dados foi carregado de uma segunda planilha do Google Drive e colunas específicas foram selecionadas. A correlação foi novamente calculada usando `corgraph`. Por fim, um scatter plot foi gerado para as variáveis DFC e PROD do segundo conjunto de dados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gsheet)\nlibrary(AgroR)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'AgroR' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'AgroR'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    desc\n```\n:::\n\n```{.r .cell-code}\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'corrplot' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\ncorrplot 0.92 loaded\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n\n# Carregar dados\nimgs <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n\n# Transformar dados e plotar boxplot\nimgs |>\n  pivot_longer(cols = 3:5, names_to = \"method\", values_to = \"value\") %>% \n  ggplot(aes(x = method, y = value)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plotar scatter plot com linha de tendência\nimgs |>\n  ggplot(aes(x = Assess, y = ImageJ)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Selecionar colunas e calcular correlação\nimgs2 <- imgs |>\ndplyr::select(3:5)\ncorgraph(imgs2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n```\n:::\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Teste de correlação\ncor.test(imgs$Assess, imgs$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  imgs$Assess and imgs$LeafDoctor\nt = 31.119, df = 68, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n```\n:::\n\n```{.r .cell-code}\ncor(imgs$Assess, imgs$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9666367\n```\n:::\n\n```{.r .cell-code}\n# Carregar e manipular segundo conjunto de dados\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\ncampo2 <- campo |>\ndplyr::select(DFC, FER, PROD)\ncorgraph(campo2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n```\n:::\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-9-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plotar scatter plot com dados de campo\ncampo |>\n  ggplot(aes(x = DFC, y = PROD)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-9-5.png){width=672}\n:::\n:::\n\n\nAs variáveis Assess, ImageJ, e LeafDoctor foram altamente correlacionadas entre si, com correlações acima de 0.97. Isso sugere que todas essas variáveis medem de maneira muito semelhante, indicando consistência entre os métodos de avaliação ou detecção usados nessas medidas. As variáveis DFC e FER tiveram uma forte correlação positiva entre si (0.93), o que sugere que conforme uma aumenta, a outra também tende a aumentar. Ambas DFC e FER têm correlações negativas significativas com PROD (-0.69 e -0.63, respectivamente), indicando que à medida que DFC e FER aumentam, PROD tende a diminuir.\n\nFoi importado dados de uma planilha do Google Drive. Em seguida, o dataframe foi agrupado por code, state e dose, e a média de germination foi calculada para cada grupo, resultando no dataframe pyra2. Este dataframe foi utilizado para criar um gráfico de dispersão das médias de germinação em função das doses, com facetas para cada code. O pacote `drc` foi carregado, e os dados filtrados para code igual a \"186\" são armazenados em isolado165. Um modelo de regressão de dose-resposta foi ajustado a esses dados (drc1), e várias análises do modelo foram realizadas, incluindo AIC, gráfico do modelo, cálculo da dose eficaz 50 (ED50) com intervalo de confiança, e um resumo do modelo. O pacote `ec50estimator` foi utilizado para estimar a EC50 para todos os dados em pyra2, agrupados por code. Os resultados foram armazenados em df_ec50 e um gráfico de pontos com barras de erro foi gerado para visualizar as estimativas de EC50, com os isolados ordenados por estimativa.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npyra <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652\")\n\npyra2 <- pyra |> \n  group_by(code, state, dose) |> \n  summarise(mean_germination = mean(germination)) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'code', 'state'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\npyra2|> \n  ggplot(aes(dose, mean_germination))+\n  geom_point()+\n  facet_wrap(~code)\n```\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(drc)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\n'drc' has been loaded.\n\nPlease cite R and 'drc' if used for a publication,\nfor references type 'citation()' and 'citation('drc')'.\n\n\nAttaching package: 'drc'\n\nThe following object is masked from 'package:AgroR':\n\n    logistic\n\nThe following objects are masked from 'package:stats':\n\n    gaussian, getInitial\n```\n:::\n\n```{.r .cell-code}\nisolado165 <- pyra2 |> \n  filter(code == \"186\")\n\ndrc1 <- drm(mean_germination ~ dose, data = isolado165,\n            fct = W1.3())\nAIC(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 20.97861\n```\n:::\n\n```{.r .cell-code}\nplot(drc1)\n```\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc1, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error    Lower    Upper\ne:1:50 0.612064   0.015429 0.562963 0.661165\n```\n:::\n\n```{.r .cell-code}\nsummary(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nModel fitted: Weibull (type 1) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  2.832159   0.213496  13.266 0.0009257 ***\nd:(Intercept) 48.767893   0.716131  68.099 6.978e-06 ***\ne:(Intercept)  0.696626   0.018156  38.368 3.895e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 1.009228 (3 degrees of freedom)\n```\n:::\n\n```{.r .cell-code}\nlibrary(ec50estimator)\ndf_ec50 <- estimate_EC50(mean_germination ~ dose,\n                         data = pyra2,\n                         isolate_col = \"code\",\n                         interval = \"delta\",\n                         fct = drc::LL.3())\n\ndf_ec50 |> \n  ggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1)+\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](Aula910_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Aula910_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}