{
  "hash": "5bf19f6cc0e02b33d849caabf262692e",
  "result": {
    "markdown": "---\ntitle: \"Aula 4\"\nformat: html\neditor: visual\n---\n\n\n##Importar dados por meio do DataPasta\n\nImportamos os dados por meio do pacote `datapasta`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(datapasta)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'datapasta' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\ndat <- tibble::tribble(\n      ~trat, ~rep, ~comp,\n      \"Mg2\",   1L,     9,\n      \"Mg2\",   2L,  12.5,\n      \"Mg2\",   3L,    10,\n      \"Mg2\",   4L,     8,\n      \"Mg2\",   5L,  13.2,\n      \"Mg2\",   6L,    11,\n      \"Mg2\",   7L,  10.8,\n      \"Mg2\",   8L,   9.5,\n      \"Mg2\",   9L,  10.8,\n      \"Mg2\",  10L,  10.4,\n  \"control\",   1L, 13.72,\n  \"control\",   2L, 15.91,\n  \"control\",   3L,  15.7,\n  \"control\",   4L,  14.2,\n  \"control\",   5L,  15.9,\n  \"control\",   6L, 16.54,\n  \"control\",   7L,    18,\n  \"control\",   8L,  14.4,\n  \"control\",   9L, 16.41,\n  \"control\",  10L,    16\n  )\n```\n:::\n\n\n## Importando dados da internet\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble::tribble(\n  \n  ~`codigo`, ~ país, ~ `n2`,\n    1L,     \"Brazil\",        4303L,\n    2L,     \"Mozambique\",      43L,\n    3L,       \"Portugal\",      33L,\n    4L,  \"United States\",      23L,\n    5L,         \"Angola\",      19L,\n    6L,          \"Spain\",      16L,\n    7L,      \"(not set)\",      12L,\n    8L,       \"Colombia\",       8L,\n    9L,        \"Germany\",       5L,\n   10L,        \"Hungary\",       5L,\n   11L, \"United Kingdom\",       5L,\n   12L,    \"Netherlands\",       4L,\n   13L,        \"Ecuador\",       3L,\n   14L,         \"France\",       3L,\n   15L,          \"Chile\",       2L,\n   16L,       \"Paraguay\",       2L,\n   17L,           \"Peru\",       2L,\n   18L,      \"Argentina\",       1L,\n   19L,        \"Austria\",       1L,\n   20L,        \"Bolivia\",       1L,\n   21L,     \"Cape Verde\",       1L,\n   22L,          \"China\",       1L,\n   23L,          \"Egypt\",       1L,\n   24L,        \"Finland\",       1L,\n   25L,          \"India\",       1L,\n   26L,          \"Italy\",       1L,\n   27L,       \"Malaysia\",       1L,\n   28L,       \"Pakistan\",       1L,\n   29L,         \"Poland\",       1L,\n   30L,      \"Singapore\",       1L,\n   31L,    \"Timor-Leste\",       1L,\n   32L,        \"Uruguay\",       1L\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 32 × 3\n   codigo país             n2\n    <int> <chr>         <int>\n 1      1 Brazil         4303\n 2      2 Mozambique       43\n 3      3 Portugal         33\n 4      4 United States    23\n 5      5 Angola           19\n 6      6 Spain            16\n 7      7 (not set)        12\n 8      8 Colombia          8\n 9      9 Germany           5\n10     10 Hungary           5\n# ℹ 22 more rows\n```\n:::\n:::\n\n\n## Importando os dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74\n  )\n```\n:::\n\n\n##Transformação de Dados\n\nConvertermos o formato da planilha com a função `pivot_longer` e criamos um gráfico utilizando as funções `geom_point` `geom_line`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npepper |>\n  pivot_longer(2:4,\n                names_to = \"epidemic\",\n                values_to = \"inc\") |>\n\n ggplot(aes(t, inc, color = epidemic))+\n   geom_point()+\n   geom_line()+\n annotate(geom = \"text\",\n          x = 12,\n          y= 0.75,\n          label= \"1\")+\n   annotate(geom = \"text\",\n          x = 25,\n          y= 0.75,\n          label= \"2\")+\n    annotate(geom = \"text\",\n          x = 40,\n          y= 0.50,\n          label= \"3\")\n```\n\n::: {.cell-output-display}\n![](Aula4_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Tabela de contingência\n\nConta o número de ocorrências para cada combinação de farm_management e cultivar, resultando em um dataframe com essas combinações e suas contagens. Criamos um gráfico, configurando cultivar no eixo x, n no eixo y, farm_management para colorir as barras e n como rótulo das barras. O código facet_wrap(\\~cultivar, scales = \"free_x\") foi utilizado para criar subgráficos separados para cada cultivar, permitindo que cada um tenha seu próprio eixo x ajustado automaticamente.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggthemes)\n\ncr <- read_csv (\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 405 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (7): region, zone, district, cultivar, shade, cropping_system, farm_mana...\ndbl (6): farm, lon, lat, altitude, inc, sev2\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ncr |>\n  count(farm_management,cultivar) |>\n  ggplot(aes(cultivar,n, fill= farm_management,\n             label = n))+\n  geom_col(position = \"dodge2\", width = 1)+\n  scale_fill_brewer()+\n  theme_bw()+\n  theme(strip.text.x= element_blank(),\n        legend.position = \"top\")+\n  geom_text(position = position_dodge (width = 0.9))+\n  facet_wrap(~cultivar, scales = \"free_x\")\n```\n\n::: {.cell-output-display}\n![](Aula4_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nUtilizamos a biblioteca `janitor` para tabular dados de um dataframe chamado cr, mostrando a frequência das combinações entre cultivar e farm_management.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(janitor)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'janitor' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'janitor'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n:::\n\n```{.r .cell-code}\ncr |>\n  tabyl(cultivar,farm_management)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n cultivar Intensive Minimal Moderate Unmanaged\n Improved        83       0        0         0\n    Local         0      10        4       102\n  Mixture        82      59       65         0\n```\n:::\n:::\n\n\n## Geom_errorbar\n\nImportamos dados do Google Drive, calculamos a média e o desvio padrão da variável (comp) agrupada por trat, e criamos um gráfico com pontos e barras de erro utilizando `ggplot2`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'gsheet' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137\")\n                 \nmg |>\n  group_by(trat)|>\n  summarise(mean_comp = mean (comp),\n                sd_comp = sd (comp)) |>\n  ggplot(aes(trat, mean_comp))+ \n  #geom_col(fill= \"steelblue\", width = 0.5)+\n  geom_point(size = 3)+\n  ylim(5,20)+\n  geom_errorbar(aes(ymin = mean_comp - sd_comp,\n                    ymax = mean_comp + sd_comp),\n                    width = 0.02)+\n  annotate(geom= \"text\",\n           x= 1, y = 17.5,\n           label = \"*\"\n           )\n```\n\n::: {.cell-output-display}\n![](Aula4_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nCriamos um gráfico de dispersão com jitter usando `ggplot2` para visualizar a variável comp em relação a trat no dataframe mg. A função geom_jitter é utilizada para adicionar um desvio aleatório aos pontos no eixo x, facilitando a visualização dos dados quando há sobreposição de pontos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg |>\n  ggplot(aes(trat,comp))+\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](Aula4_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Aula4_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}